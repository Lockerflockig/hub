{
  "db_name": "SQLite",
  "query": "-- Aggregierte Fremdspionage-Ãœbersicht\n-- Gruppiert nach Angreifer-Koordinaten, mit Spieler/Allianz-Info und Filter\nSELECT\n    hs.attacker_coordinates AS \"attacker_coordinates!\",\n    p.name AS attacker_name,\n    a.tag AS attacker_alliance_tag,\n    COUNT(*) AS \"spy_count!: i64\",\n    MAX(hs.report_time) AS last_spy_time,\n    GROUP_CONCAT(DISTINCT hs.target_coordinates) AS targets\nFROM hostile_spying hs\nLEFT JOIN planets pl ON pl.coordinates = hs.attacker_coordinates AND pl.type = 'PLANET'\nLEFT JOIN players p ON p.id = pl.player_id\nLEFT JOIN alliances a ON a.id = p.alliance_id\nWHERE 1=1\n    -- Filter: Spionierender Spieler (Name oder Koordinaten)\n    AND (? IS NULL OR p.name LIKE '%' || ? || '%' OR hs.attacker_coordinates LIKE '%' || ? || '%')\n    -- Filter: Spionierter Spieler (Ziel-Koordinaten)\n    AND (? IS NULL OR hs.target_coordinates LIKE '%' || ? || '%')\n    -- Filter: Zeitraum (von)\n    AND (? IS NULL OR hs.report_time >= ?)\n    -- Filter: Zeitraum (bis)\n    AND (? IS NULL OR hs.report_time <= ?)\nGROUP BY hs.attacker_coordinates\nORDER BY MAX(hs.report_time) DESC\nLIMIT ? OFFSET ?;\n",
  "describe": {
    "columns": [
      {
        "name": "attacker_coordinates!",
        "ordinal": 0,
        "type_info": "Text"
      },
      {
        "name": "attacker_name",
        "ordinal": 1,
        "type_info": "Text"
      },
      {
        "name": "attacker_alliance_tag",
        "ordinal": 2,
        "type_info": "Text"
      },
      {
        "name": "spy_count!: i64",
        "ordinal": 3,
        "type_info": "Integer"
      },
      {
        "name": "last_spy_time",
        "ordinal": 4,
        "type_info": "Text"
      },
      {
        "name": "targets",
        "ordinal": 5,
        "type_info": "Text"
      }
    ],
    "parameters": {
      "Right": 11
    },
    "nullable": [
      true,
      true,
      true,
      false,
      true,
      true
    ]
  },
  "hash": "0d6fa18f88eba68e5bef6ace9b6e482ee120a87007fce3fe376872b26df82203"
}
