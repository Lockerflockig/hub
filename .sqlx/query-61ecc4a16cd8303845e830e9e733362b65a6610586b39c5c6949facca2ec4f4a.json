{
  "db_name": "SQLite",
  "query": "-- Aggregierte Fremdspionage-Ãœbersicht\r\n-- Gruppiert nach Angreifer-Koordinaten, mit Spieler/Allianz-Info und Filter\r\nSELECT\r\n    hs.attacker_coordinates AS \"attacker_coordinates!\",\r\n    p.name AS attacker_name,\r\n    a.tag AS attacker_alliance_tag,\r\n    COUNT(*) AS \"spy_count!: i64\",\r\n    MAX(hs.report_time) AS last_spy_time,\r\n    GROUP_CONCAT(DISTINCT hs.target_coordinates) AS targets\r\nFROM hostile_spying hs\r\nLEFT JOIN planets pl ON pl.coordinates = hs.attacker_coordinates AND pl.type = 'PLANET'\r\nLEFT JOIN players p ON p.id = pl.player_id\r\nLEFT JOIN alliances a ON a.id = p.alliance_id\r\nWHERE 1=1\r\n    -- Filter: Spionierender Spieler (Name oder Koordinaten)\r\n    AND (? IS NULL OR p.name LIKE '%' || ? || '%' OR hs.attacker_coordinates LIKE '%' || ? || '%')\r\n    -- Filter: Spionierter Spieler (Ziel-Koordinaten)\r\n    AND (? IS NULL OR hs.target_coordinates LIKE '%' || ? || '%')\r\n    -- Filter: Zeitraum (von)\r\n    AND (? IS NULL OR hs.report_time >= ?)\r\n    -- Filter: Zeitraum (bis)\r\n    AND (? IS NULL OR hs.report_time <= ?)\r\nGROUP BY hs.attacker_coordinates\r\nORDER BY MAX(hs.report_time) DESC\r\nLIMIT ? OFFSET ?;\r\n",
  "describe": {
    "columns": [
      {
        "name": "attacker_coordinates!",
        "ordinal": 0,
        "type_info": "Text"
      },
      {
        "name": "attacker_name",
        "ordinal": 1,
        "type_info": "Text"
      },
      {
        "name": "attacker_alliance_tag",
        "ordinal": 2,
        "type_info": "Text"
      },
      {
        "name": "spy_count!: i64",
        "ordinal": 3,
        "type_info": "Integer"
      },
      {
        "name": "last_spy_time",
        "ordinal": 4,
        "type_info": "Text"
      },
      {
        "name": "targets",
        "ordinal": 5,
        "type_info": "Text"
      }
    ],
    "parameters": {
      "Right": 11
    },
    "nullable": [
      true,
      true,
      true,
      false,
      true,
      true
    ]
  },
  "hash": "61ecc4a16cd8303845e830e9e733362b65a6610586b39c5c6949facca2ec4f4a"
}
